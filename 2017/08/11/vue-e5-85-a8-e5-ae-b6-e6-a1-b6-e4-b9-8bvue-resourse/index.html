<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Shady"><title>Vue全家桶之Vue-resource · Libx</title><meta name="description" content="Vue-resource是vue的一个AJAX工具，在使用时为开发者带来了很大的方便，相比axios，vue-resource已经停止维护，官方推荐的也是axios，但是我还没有用过。他们两个的具体区别我并不知道。。这里不做评价。
暑期留校总结&amp;lt;三&amp;gt;—— Vue-resource因为在做"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><h3 title=""><a href="/">Libx</a></h3><div class="description"><p>Thoughts,stories and ideas</p></div></div></div><ul class="social-links"></ul><div class="footer"><a target="_blank" href="/"><span>© 2017 — 2018 ❤ Shady</span></a></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>Vue全家桶之Vue-resource</a></h3></div><div class="post-content"><p>Vue-resource是vue的一个AJAX工具，在使用时为开发者带来了很大的方便，相比axios，vue-resource已经停止维护，官方推荐的也是axios，但是我还没有用过。他们两个的具体区别我并不知道。。这里不做评价。</p>
<h2 id="暑期留校总结-lt-三-gt-——-Vue-resource"><a href="#暑期留校总结-lt-三-gt-——-Vue-resource" class="headerlink" title="暑期留校总结&lt;三&gt;—— Vue-resource"></a>暑期留校总结&lt;三&gt;—— Vue-resource</h2><p>因为在做的小项目中使用的是Vue-resource，所以在这里对Vue-resource来进行一下总结。</p>
<p>最开始当然还是官方文档：<a href="https://github.com/pagekit/vue-resource" target="_blank" rel="external">地址在此</a></p>
<p>Vue-resource在使用中其实可以使用Jquery来代替，Vue-resours与Vue并无非常大的联系，甚至很多其他的库也可替代，这应该也是Vue-resource在2.0中不再作为官方推荐AJAX工具了吧，但是相比之下，我们还是可以看到的他的特点以及优点</p>
<h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><p><strong>1. 体积小</strong></p>
<p>vue-resource非常小巧，在压缩以后只有大约12KB，服务端启用gzip压缩后只有4.5KB大小，这远比jQuery的体积要小得多。</p>
<p><strong>2. 支持主流的浏览器</strong></p>
<p>和Vue.js一样，vue-resource除了不支持IE 9以下的浏览器，其他主流的浏览器都支持。</p>
<p><strong>3. 支持<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="external">Promise</a> API和<a href="https://medialize.github.io/URI.js/uri-template.html" target="_blank" rel="external">URI Templates</a></strong></p>
<p>Promise是ES6的特性，Promise的中文含义为“先知”，Promise对象用于异步计算。<br>URI Templates表示URI模板，有些类似于ASP.NET MVC的路由模板。</p>
<p><strong>4. 支持拦截器</strong></p>
<p>拦截器是全局的，拦截器可以在请求发送前和发送请求后做一些处理。<br>拦截器在一些场景下会非常有用，比如请求发送前在headers中设置access_token，或者在请求失败时，提供共通的处理方式。</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>当然还是老伙计npm ：<code>npm install Vue-resource</code>,</p>
<p>ES6 中引入：<br><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> VueResource <span class="keyword">from</span> <span class="string">'vue-resource'</span></div><div class="line">Vue.use(VueResource)</div><div class="line">先来看一下官方给的最简单的demo：</div><div class="line">&#123;</div><div class="line">  <span class="comment">// GET /someUrl</span></div><div class="line">  <span class="keyword">this</span>.$http.get(<span class="string">'/someUrl'</span>).then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</div><div class="line"><span class="comment">// get body data</span></div><div class="line"><span class="keyword">this</span>.someData = response.body;</div><div class="line">  &#125;, (response) =&gt; &#123;</div><div class="line"><span class="comment">// error callback</span></div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="基本使用："><a href="#基本使用：" class="headerlink" title="基本使用："></a>基本使用：</h3><p>Vue-resource，有两种使用方法：</p>
<ul>
<li>使用Vue.http或this.$http</li>
<li>使用Vue.resource或this.$resource<br>实际上，第二种方法的实现也是基于第一种方法来实现的，所以我们在这里只讨论第一种方法</li>
</ul>
<p><br><span class="hljs-comment">// 基于全局Vue对象使用http</span><br>Vue.http.get(<span class="hljs-string">‘/someUrl’</span>, [options]).then(successCallback, errorCallback);<br>Vue.http.post(<span class="hljs-string">‘/someUrl’</span>, [body], [options]).then(successCallback, errorCallback);</p>
<p><span class="hljs-comment">// 在一个Vue实例内使用$http</span><br><span class="hljs-keyword">this</span>.$http.get(<span class="hljs-string">‘/someUrl’</span>, [options]).then(successCallback, errorCallback);<br><span class="hljs-keyword">this</span>.$http.post(<span class="hljs-string">‘/someUrl’</span>, [body], [options]).then(successCallback, errorCallback);<br>而在回掉函数中，我们推荐使用ES6的写法（代码会简洁很多）：<br>.then(<br>  (response) =&gt; {<br><span class="hljs-comment">// 响应成功回调</span><br>  },<br>   (response) =&gt; {<br><span class="hljs-comment">// 响应错误回调</span><br>  }<br>);</p>
<p>通常我们还是需要写一个catch来包住错误。</p>
<h3 id="请求："><a href="#请求：" class="headerlink" title="请求："></a>请求：</h3><p>Vue-resource提供了一下七种请求：</p>
<ul>
<li><code>get(url, [options])</code></li>
<li><code>head(url, [options])</code></li>
<li><code>delete(url, [options])</code></li>
<li><code>jsonp(url, [options])</code></li>
<li><code>post(url, [body], [options])</code></li>
<li><code>put(url, [body], [options])</code></li>
<li><code>patch(url, [body], [options])</code><br>发送请求时的options选项对象包含以下属性：<table class="post-table"><br><thead><br><tr><br><th width="134">参数</th><br><th width="212">类型</th><br><th width="628">描述</th><br></tr><br></thead><br><tbody><br><tr><br><td width="134">url</td><br><td width="212"><code>string</code></td><br><td width="628">请求的URL</td><br></tr><br><tr><br><td width="134">method</td><br><td width="212"><code>string</code></td><br><td width="628">请求的HTTP方法，例如：’GET’, ‘POST’或其他HTTP方法</td><br></tr><br><tr><br><td width="134">body</td><br><td width="212"><code>Object</code>, <code>FormData</code> <code>string</code></td><br><td width="628">request body</td><br></tr><br><tr><br><td width="134">params</td><br><td width="212"><code>Object</code></td><br><td width="628">请求的URL参数对象</td><br></tr><br><tr><br><td width="134">headers</td><br><td width="212"><code>Object</code></td><br><td width="628">request header</td><br></tr><br><tr><br><td width="134">timeout</td><br><td width="212"><code>number</code></td><br><td width="628">单位为毫秒的请求超时时间 (<code>0</code> 表示无超时时间)</td><br></tr><br><tr><br><td width="134">before</td><br><td width="212"><code>function(request)</code></td><br><td width="628">请求发送前的处理函数，类似于jQuery的beforeSend函数</td><br></tr><br><tr><br><td width="134">progress</td><br><td width="212"><code>function(event)</code></td><br><td width="628"><a href="https://developer.mozilla.org/en-US/docs/Web/API/ProgressEvent" target="_blank" rel="external">ProgressEvent</a>回调处理函数</td><br></tr><br><tr><br><td width="134">credentials</td><br><td width="212"><code>boolean</code></td><br><td width="628">表示跨域请求时是否需要使用凭证</td><br></tr><br><tr><br><td width="134">emulateHTTP</td><br><td width="212"><code>boolean</code></td><br><td width="628">发送PUT, PATCH, DELETE请求时以HTTP POST的方式发送，并设置请求头的<code>X-HTTP-Method-Override</code></td><br></tr><br><tr><br><td width="134">emulateJSON</td><br><td width="212"><code>boolean</code></td><br><td width="628">将request body以<code>application/x-www-form-urlencoded</code> content type发送</td><br></tr><br></tbody><br></table>

</li>
</ul>
<h4 id="emulateHTTP的作用：（虽然我还没有用过，不过看起来好像很有用的样子）"><a href="#emulateHTTP的作用：（虽然我还没有用过，不过看起来好像很有用的样子）" class="headerlink" title="emulateHTTP的作用：（虽然我还没有用过，不过看起来好像很有用的样子）"></a>emulateHTTP的作用：（虽然我还没有用过，不过看起来好像很有用的样子）</h4><p>背一段书：</p>
<p>如果Web服务器无法处理PUT, PATCH和DELETE这种REST风格的请求，你可以启用enulateHTTP现象。启用该选项后，请求会以普通的POST方法发出，并且HTTP头信息的<code>X-HTTP-Method-Override</code>属性会设置为实际的HTTP方法。<br><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line">Vue.http.options.emulateHTTP = <span class="literal">true</span></div></pre></td></tr></table></figure></p>
<h4 id="emulateJSON的作用"><a href="#emulateJSON的作用" class="headerlink" title="emulateJSON的作用"></a>emulateJSON的作用</h4><p>如果Web服务器无法处理编码为application/json的请求，你可以启用emulateJSON选项。启用该选项后，请求会以<code>application/x-www-form-urlencoded</code>作为MIME type，就像普通的HTML表单一样。<br><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line">Vue.http.options.emulateJSON = <span class="literal">true</span></div></pre></td></tr></table></figure></p>
<h3 id="返回：response对象"><a href="#返回：response对象" class="headerlink" title="返回：response对象"></a>返回：response对象</h3><p>response对象包含以下属性：</p>
<table class="post-table"><br><thead><br><tr><br><th>方法</th><br><th>类型</th><br><th>描述</th><br></tr><br></thead><br><tbody><br><tr><br><td>text()</td><br><td><code>string</code></td><br><td>以string形式返回response body</td><br></tr><br><tr><br><td>json()</td><br><td><code>Object</code></td><br><td>以JSON对象形式返回response body</td><br></tr><br><tr><br><td>blob()</td><br><td><code>Blob</code></td><br><td>以二进制形式返回response body</td><br></tr><br><tr><br><td><strong>属性</strong></td><br><td><strong>类型</strong></td><br><td><strong>描述</strong></td><br></tr><br><tr><br><td>ok</td><br><td><code>boolean</code></td><br><td>响应的HTTP状态码在200~299之间时，该属性为true</td><br></tr><br><tr><br><td>status</td><br><td><code>number</code></td><br><td>响应的HTTP状态码</td><br></tr><br><tr><br><td>statusText</td><br><td><code>string</code></td><br><td>响应的状态文本</td><br></tr><br><tr><br><td>headers</td><br><td><code>Object</code></td><br><td>响应头</td><br></tr><br></tbody><br></table>

<h3 id="实例："><a href="#实例：" class="headerlink" title="实例："></a>实例：</h3><p>在此不再完整的实现所有的CURD请求，因为这实在是大同小异，无非是多加几个参数的区别</p>
<p>在这里手写一个POST请求：</p>
<p>（不写了。。。）</p>
<h3 id="Vue-resource中的重头戏：inteceptor"><a href="#Vue-resource中的重头戏：inteceptor" class="headerlink" title="Vue-resource中的重头戏：inteceptor"></a>Vue-resource中的重头戏：<strong>inteceptor</strong></h3><p><img src="http://images2015.cnblogs.com/blog/341820/201607/341820-20160710080109342-1842115136.png" alt=""></p>
<h4 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h4><p>Vue.http.interceptors.push((request, next) =&gt; {<br><span class="hljs-comment">// …</span><br><span class="hljs-comment">// 请求发送前的处理逻辑</span><br><span class="hljs-comment">// …</span><br>next((response) =&gt; {<br><span class="hljs-comment">// …</span><br><span class="hljs-comment">// 请求发送后的处理逻辑</span><br><span class="hljs-comment">// …</span><br><span class="hljs-comment">// 根据请求的状态，response参数会返回给successCallback或errorCallback</span><br><span class="hljs-keyword">return</span> response<br>})<br>})<br><br>在response返回给successCallback或errorCallback之前，你可以修改response中的内容，或做一些处理。<br>例如，响应的状态码如果是404，你可以显示友好的404界面。</p>
<p>实例：</p>
<p>使用拦截器，我们可以非常容易地实现loading动画的转场，</p>
<p>比如：（这里只给出关键代码）<br><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line">Vue.http.interceptors.push(<span class="function">(<span class="params">request, next</span>) =&gt;</span> &#123;</div><div class="line">loading.show = <span class="literal">true</span></div><div class="line">next(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</div><div class="line">loading.show = <span class="literal">false</span></div><div class="line"><span class="keyword">return</span> response</div><div class="line">&#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><p>Vue-resource是非常好用的一个处理请求的工具，虽然已经停止维护，但是依然可以作为一个选择。前几天看到了一篇文章<a href="https://zhuanlan.zhihu.com/p/28396592?utm_source=qq&amp;utm_medium=social" target="_blank" rel="external">《 【源码拾遗】axios —— 极简封装的艺术》</a>讲的是axios的源码是如何的优美，我看了一点代码，但是完全看不到他的优美的地方，甚至有很多地方看不懂。。。可能我还是太垃圾，等到再学一段时间再来啃吧。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2017-08-11</span><i class="fa fa-tag"></i><a class="tag" href="/categories/技术/" title="技术">技术 </a><a class="tag" href="/tags/Vue/" title="Vue">Vue </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" href="http://twitter.com/home?status=,http://stan1812.github.io/2017/08/11/vue-e5-85-a8-e5-ae-b6-e6-a1-b6-e4-b9-8bvue-resourse/,Libx,Vue全家桶之Vue-resource,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2017/08/13/vue-e5-85-a8-e5-ae-b6-e6-a1-b6-e4-b9-8bvuex/" title="VUe全家桶之VueX">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2017/08/11/vue-e5-85-a8-e5-ae-b6-e6-a1-b6-e4-b9-8bvue-router-e3-80-81/" title="Vue全家桶之Vue-router">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>